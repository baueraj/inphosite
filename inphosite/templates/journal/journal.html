<%inherit file="/base-tree.html"/>
<%namespace name="entity" file="/entity/entity.html" />
<%namespace name="form" file="/form.html" />

<%def name="label()">
%if c.entity.abbrs and len(c.entity.label) > 50:
${c.entity.abbrs[0]}
%else:
${c.entity.label}
%endif
</%def>

<%def name="title()">Journal - ${label()}</%def>
<%def name="head_title()">${label()}</%def>
<%def name="sidebar()">
${parent.sidebar()}
<br />
${parent.draw()}</%def>

<div class="yui-gd">
<script src="/js/admin.js" type="text/javascript"></script>
<script type="text/javascript">
function srch(id) {
    var src  = '/entity/' + id + '/search';
    $.get(src, function(data){
          $("#moreInfo").html(data);
        });
}
//$(document).ready(srch(${c.entity.ID}));
</script>

<div id="content">
<h1>${c.entity.label}</h1>
</div>

<div id="contentLeft">

## If user is authorised, show admin panel
%if h.auth.is_admin():
  ${adminPanel()}
%else:
  <dl>
    %if c.entity.URL:
    <dt><a href="${c.entity.URL}">Web Site</a></dt>
    <br />
    %endif

    %if c.entity.language:
    <dt>Language:</dt>
    <dd>${c.entity.language}</dd>
	<br />
    %endif

    %if c.entity.ISSN:
    <dt>ISSN:</dt>
    <dd>${c.entity.ISSN}</dd>
	<br />
    %endif
    
    %if c.entity.abbrs:
    <dt>Abbreviations:</dt>
    %for abbr in c.entity.abbrs:
    <dd>${abbr}</dd>
    %endfor
	<br />
    %endif
    
    %if c.entity.openAccess or c.entity.student or not c.entity.active:
    <dt>Extra:</dt>
    %if c.entity.openAccess:
    <dd>Open Access</dd>
    %endif
    %if c.entity.student:
    <dd>Student Journal</dd>
    %endif
    %if not c.entity.active:
    <dd>Inactive</dd>
    %endif
    %endif
  </dl>
%endif

</div> <!-- contentLeft -->

<div id="moreInfo">
    <p>Loading search results ...</p><p><img src='/img/loading.gif' /></p>
</div>
</div> <!-- wrapper -->

<%def name="adminPanel()">
<form>
    <fieldset>
        <legend>Admin Panel</legend>
${form.toggletext("ID", uneditable=True)}
##${form.toggletext("type")}
${form.toggletext("label")}
${form.toggletext("sep_dir")}
${form.toggletext("URL")}
${form.toggletext("last_accessed", uneditable=True)}
${form.toggletext("language")}
${form.toggletext("ISSN")}
${form.checkbox_group([('active', 'Active'), ('openAccess', "Open Access"), ('student', "Student Journal")], 'Properties')}
    </fieldset>
</form>
</%def>

